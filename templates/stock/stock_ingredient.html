{% extends 'layout/store/base_store.html' %}
{% load static %}

{% block title %}Store | Stock{% endblock %}
{% block store_id %}store_id{% endblock %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">

{% block content %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <hr/>
    <h3 style="margin-bottom: 50px;" class="text-center">재고관리 - 재료</h3>
    
    
<style>
/* 기존 CSS 스타일 유지 */
.stock-ingredient-table table {
    border-collapse: collapse;
    width: 100%;
}
.stock-ingredient-table th, td {
    border: 1px solid black;
    padding: 8px;
    text-align: center;
}
.stock-ingredient-table thead {
    border-bottom: 3px solid black;
}
.stock-ingredient-table .checkbox-column {
    width: 50px;
}

.stock-ingredient-table tbody tr {
    cursor: pointer;
}
.stock-ingredient-table tbody tr:hover {
    background-color: gray;
}
</style>

<!-- 버튼과 검색창을 한 줄에 배치 -->
<div class="d-flex justify-content-between align-items-center mt-3 mb-4" style="width: 100%;"> 

  <!-- 검색창 (오른쪽 정렬) -->
  <div style="flex-grow: 1; display: flex; justify-content: flex-end;">
    <form method="post" class="d-flex" role="search" id="search-form">
      {% csrf_token %}
      <input class="form-control me-2 search-input" type="search" id="search-input" placeholder="재료명을 입력하세요" aria-label="Search" style="padding: 10px; width: 250px; border: 1px solid #ccc; border-radius: 5px;">
      <button id="search_button" type="submit" name="search_button" style="background-color: lightgoldenrodyellow; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">검색</button>
    </form>
  </div>
</div>

<!-- 테이블 -->
<table class="table stock-ingredient-table">
  <thead>
    <tr>
      <th class="checkbox-column"><input type="checkbox" id="select-all"></th>
      <th scope="col">재료 ID</th>
      <th scope="col">재료명</th>
      <th scope="col">
        <select class="form-select form-select-sm" name="store" id="store-filter" onchange="filterStore()">
          <option value="" style="text-align: center;">전체 매장</option>
          <option value="A" style="text-align: center;" {% if request.GET.store == "A" %}selected{% endif %}>서초점 (A)</option>
          <option value="B" style="text-align: center;" {% if request.GET.store == "B" %}selected{% endif %}>강남점 (B)</option>
        </select>
      </th>
      <th scope="col" onclick="sortTable()">▲ 재고수량 ▼<i class="bi bi-sort-down-alt"></i></th>
    </tr>
  </thead>
  <tbody>
    {% for ingredient in page_obj %}
    <tr>
        <td class="checkbox-column"><input type="checkbox" class="row-checkbox"></td>
        <td>{{ ingredient.ingredient_id }}</td>
        <td>{{ ingredient.ingredient_name }}</td>
        <td>{{ ingredient.store }}</td>
        <td id="stock-{{ ingredient.id }}">{{ ingredient.stock }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

    <!-- 삭제와 신규등록을 한 줄에 배치 -->
    <div class="d-flex justify-content-between align-items-center mt-3" style="width: 100%;">

    <!-- 삭제 버튼 (왼쪽 정렬) -->
    <div class="member-container" style="flex-shrink: 0;">
        <button class="btn btn-danger" type="button" data-bs-toggle="modal" data-bs-target="#deleteConfirmModal">삭제</button>
    </div>

    <!-- 신규등록 버튼 (오른쪽 정렬) -->
    <div style="flex-shrink: 0;">
        <a class="btn btn-primary signup-btn" onclick="location.href='{% url 'main:signup' %}'">신규등록</a>
    </div>
    </div>
    
    <!-- 페이지 네비게이션 (중앙) -->
    <nav aria-label="Page navigation">
        <ul class="pagination mb-0">
            <!-- 이전 버튼 -->
            <li class="page-ingredient {% if page_obj.has_previous %}enabled{% else %}disabled{% endif %}">
                {% if page_obj.has_previous %}
                    <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                        <span aria-hidden="true">&laquo; 이전</span>
                    </a>
                {% else %}
                    <span class="page-link" aria-label="Previous">
                        <span aria-hidden="true">&laquo; 이전</span>
                    </span>
                {% endif %}
            </li>

            <!-- 페이지 번호들 -->
            {% for num in page_obj.paginator.page_range %}
                <li class="page-ingredient {% if page_obj.number == num %}active{% endif %}">
                    <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                </li>
            {% endfor %}

            <!-- 다음 버튼 -->
            <li class="page-ingredient {% if page_obj.has_next %}enabled{% else %}disabled{% endif %}">
                {% if page_obj.has_next %}
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                        <span aria-hidden="true">다음 &raquo;</span>
                    </a>
                {% else %}
                    <span class="page-link" aria-label="Next">
                        <span aria-hidden="true">다음 &raquo;</span>
                    </span>
                {% endif %}
            </li>
        </ul>
    </nav>

{% endblock content %}

{% block script %}
<script src="{% static 'js/stock_ingredient.js' %}"></script>
{% endblock %}
