{% extends 'layout/store/base_store.html' %}
{% load static %}

{% block title %}ê²°ì œê´€ë¦¬{% endblock title %}

{% block header %}
    {% include 'layout/store/header_store.html' %}
{% endblock header %}

{% block sidebar %}
    {% include 'layout/store/sidebar_store.html' %}
{% endblock sidebar %}

{% block content %}
    <h3 class="text-center">ì·¨ì†Œ ë‚´ì—­</h3>

    <div style="display: flex; gap:30px; margin-bottom: 20px;">
        <input type="datetime-local" name="startDate" id="startDate">
        <p>-</p>
        <input type="datetime-local" name="endDate" id="endDate">
        <button id="date_button" style="background-color:lightgoldenrodyellow;">ê²€ìƒ‰</button>
    </div>

    <table class="table table-bordered text-center">
        <thead>
            <tr>
                <th>ê²°ì œì¼ì‹œ</th>
                <th>ë§¤ì¥ëª…</th>
                <th>ì´ìˆ˜ëŸ‰</th>
                <th>ì´ê¸ˆì•¡</th>
                <th>ì ë¦½í¬ì¸íŠ¸</th>
                <th>ê²°ì œìˆ˜ë‹¨</th>
                <th>íšŒì›ì—¬ë¶€</th>
            </tr>
        </thead>
        <tbody>
            {% for cancel in cancels %}
            {# ğŸ”¥<tr style="color: red;">#}
            <tr>
                <td class="clickable" data-payment-id="{{ cancel.payment_id }}">
                    <a href="{% url 'pay:pay_details' cancel.payment_id %}">{{ cancel.pay_at|date:"Y-m-d H:i" }}</a>
                </td>
                <td>{{ cancel.order.store }}</td>
                ğŸ”¥<td>{{ cancel.order.ì´ìˆ˜ëŸ‰ }}</td>
                <td>{{ cancel.order.total_amount }}</td>
                <td>{{ cancel.order.earned_points }}</td>
                <td>
                    {% if cancel.payment_method == "credit" %}
                        <span class="badge bg-danger">ì¹´ë“œ</span>
                    {% elif cancel.payment_method == "cash" %}
                        <span class="badge bg-success">í˜„ê¸ˆ</span>
                    {% endif %}
                </td>
                <td>
                    {% if cancel.member %}
                        <span class="badge bg-primary">íšŒì›</span>
                    {% else %}
                        <span class="badge bg-warning">ë¹„íšŒì›</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">ì·¨ì†Œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            {% endfor %}
        </tbody>

    </table>
{% endblock content %}

{% block script %}
<script>
    document.getElementById("date_button").addEventListener("click", function() {
        let startDate = new Date(document.getElementById("startDate").value);
        let endDate = new Date(document.getElementById("endDate").value);
        let rows = document.querySelectorAll(".table tbody tr");

        rows.forEach(row => {
            let dateCell = row.querySelector("td:first-child");
            if (dateCell) {
                let purchaseDate = new Date(dateCell.innerText);
                if (purchaseDate >= startDate && purchaseDate <= endDate) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        });
    });
</script>
{% endblock script %}
